# Output Files Guide

This document explains all the output files generated by the energy system simulation.

## Generated Files

After running `python simulate.py --config <config_file>`, the following files are created in the `output/` directory:

### 1. Simulation Results
- **simulation_results.csv** - Complete timestep-by-timestep simulation data including:
  - PV generation, load, battery SOC, grid import/export
  - Energy flows (PV to load, battery to load, etc.)
  - Self-sufficiency, grid stability, unmet load
  - **blackout column** - Boolean flag for hours with insufficient power

- **simulation_results_data.csv** - Extracted plot data for the main results chart

### 2. Blackout Analysis
- **blackout_events.csv** - Detailed blackout event summary with:
  - Event ID, start/end times, duration (hours)
  - Unserved energy (kWh)
  - Battery SOC during event (min/avg %)
  - Grid down fraction (0-1, shows if blackout caused by grid failure)

**Console output shows:**
- Number of blackout events
- Total blackout hours
- Longest blackout duration
- Total unserved energy

### 3. Visualization Files

All charts are saved in **three formats**:

#### PNG Format (High Resolution)
- `simulation_results.png` (300 DPI) - 5-panel main results
- `cumulative_energy_flows.png` (150 DPI)
- `cost_comparison.png` (150 DPI)
- `cost_over_time.png` (150 DPI)

#### SVG Format (Vector Graphics)
- `simulation_results.svg` - Scalable, editable in Inkscape/Illustrator
- `cumulative_energy_flows.svg`
- `cost_comparison.svg`
- `cost_over_time.svg`

#### Raw Plot Data (CSV)
- `cumulative_energy_flows_data.csv` - Cumulative PV, load, grid import/export, net grid
- `cost_comparison_data.csv` - System comparison: baseline vs solar costs breakdown
- `cost_over_time_data.csv` - Cumulative costs over time for both systems

### 4. Plot Visual Markers

In the main simulation plots, you'll see:
- **Red vertical lines** (transparent) - Grid instability periods (grid down)
- **Black vertical lines** (darker) - Actual blackouts (unmet load > 0)

This distinction is critical:
- Grid can be down but if battery has energy → no blackout
- Blackout only occurs when PV + Battery + Grid cannot meet load

## File Usage

### For Analysis
- Use **CSV files** to import data into Excel, Python, R, or other tools
- `simulation_results.csv` contains the complete timestep data
- `blackout_events.csv` provides event-level summaries

### For Reports/Publications
- Use **PNG files** for high-quality raster images in documents
- Use **SVG files** for:
  - Presentations (infinite zoom without pixelation)
  - Publications requiring vector graphics
  - Editing/customization in graphics software

### For Further Processing
- Use **_data.csv files** to:
  - Recreate plots with different styling
  - Combine data from multiple simulation runs
  - Generate custom visualizations

## Key Metrics Summary

The simulation provides comprehensive resilience metrics:

### Energy Metrics
- Total PV generation
- Total load consumption
- Grid import/export
- Self-sufficiency percentage
- Unmet load (kWh)

### Financial Metrics
- Grid import costs
- Grid export revenue
- Net profit/cost
- Baseline system comparison (grid + diesel)
- Total savings vs baseline

### Resilience Metrics (NEW)
- Number of blackout events
- Total blackout duration (hours)
- Longest single blackout
- Unserved energy (kWh)
- Battery SOC during blackouts
- Grid contribution to blackouts

## Example Workflow

1. **Run simulation:**
   ```bash
   python simulate.py --config simulation_config_seasonal.yaml
   ```

2. **Check console output** for summary statistics

3. **Review blackout events:**
   ```bash
   # PowerShell
   Get-Content output\blackout_events.csv
   
   # Or open in Excel
   start output\blackout_events.csv
   ```

4. **View plots:**
   - Open PNG files for quick viewing
   - Open SVG files in browser or Inkscape for editing

5. **Analyze data:**
   - Import CSV files into your analysis tool
   - Combine multiple simulation runs for comparison

## Notes

- All timestamps use 24-hour format
- Energy values in kWh
- Costs in Euros (€)
- SOC (State of Charge) as percentage (0-100%)
- Grid stability: True = grid available, False = grid down
- Blackout: True = load not fully met, False = all load served
